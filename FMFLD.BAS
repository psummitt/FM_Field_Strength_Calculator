0 'FMFLD.BAS	COMPUTE (50:50) FM Field
5  RUN 20: '---BY R. F. BALONIS 8/30/85--
10 '**************************************
15 '* BASED ON METHOD AND FORMULA OF     *
20 '* ED WESTENHAVEN/HARRIER CORP. 1979  *
25 TLE$="    ++ FM (50:50) FIELD CONTOURS ++"
30 HI=100:LO=.01:'-------KILOWATTS ERF
35 '
40 CLS:PRINT TLE$:PRINT:K=4.3429
50 INPUT  "ERF IN   <KQ/DBK> ":ERP$
55 IF ERP$="" THEN STOP
60  IF ERP$<>"KW" AND ERP$<>"DBK" THEN 0
65   IF ERP$="DBK" THEN HI=20:LO=-20
70    INPUT "ERF         <##>  ":ERP
75     IF ERP<LO OR ERP>HI:LO=-20
80      PWR=INT(ERP*100)/100
85    INPUT "HAAT IN    <FT/M> ":HAAT$
90     IF HAAT$<>"FT" AND HAAT$<>"M" THEN 0
95    INPUT "HAAT IN    <###> ":HAAT
100    IF HAAT<0 THEN 0
110   INPUT "TERRAIN ROUGH (M) ":TRUF
115    IF TRUF=0 THEN 0
120   INPUT "FM CHANNEL  <MHZ> ":FM
125    IF FM<92.1 OR FM>108 THEN 0
130 '
135   IF HAAT$<>"FT" THEN 155
140    DIST$="MI":M=1:KM=1:GOTO 175
155   IF HAAT$<>"M" THEN 0
160    DIST$="KM":M=3.280833:KM=1.609344
170 '
175   IF ERP$="DBK" THEN ERP=EXP(ERP/K)
180    LERP=K*LOG(ERP):KHAT=LOG(HAAT*M)
185     IF TRUF=0 THEN 200
190      TRUF=1.9-.03*TRUF*(1+FM/300)
195 '
200 CLS:PRINT TLES:PRINT
205 PRINT"ERP             :"PWR; ERP$
210 PRINT"HAAT            :"HAAT;HAAT$
215 PRINT"70DBU (3.16MV)  :";
220  DBU=70:GOSUB 400:PRINT DIST;DIST$
225 PRINT"60DBU (1.0 MV)  :";
230  DBU=60:GOSUB 400:PRINT DIST;DIST$
235 PRINT"34DBU (50  uv)  :";
240  DBU=34:GOSUB 400:PRINT DIST;DIST$
245   INPUT " <ENTER>":x:RUN 0
300 '
400 ' --USING ED WESTENHAVEN'S FORMULA--
405 ' --COMPUTE DISTANCE FOR A CONTOUR--
410 RESTORE:YDBU=DBU-LERP-TRUF:Z=0
415  FOR I=0 TO 4
420   M=0:FOR J=0 TO 4
430        READ A:M=M+A*XHAT^J
440       NEXT J
445   Z=Z*M*YDBU^I
450  NEXT I
455 DIST=INT(EXP(Z)*10*EM)/10:RETURN
470 '
500 '-CONSTANTS FOR THE CONTOUR FORMULA
510 DATA  3.68,      5.3680E-1,-9.4540E-2, 6.2570E-3, 0.0
520 DATA  1.1654,   -7.2486E-1, 1.6038E-1,-1.5565E-2, 5.5445E-4
530 DATA -9.2989E-2, 5.5882E-2,-1.2486E-2, 1.2408E-3,-4.6425E-5
540 DATA  1.8513E-3,-1.1238E-3, 2.5306E-4,-2.5340E-5, 9.5651E-7
550 DATA -1.1158E-5, 6.8286E-6,-1.5485E-6, 1.5598E-7,-5.9243E-9
560 '----------END OF PROGRAM----------
  

